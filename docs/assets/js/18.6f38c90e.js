(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{112:function(s,t,e){s.exports=e.p+"assets/img/image-20190715085036593.55559549.png"},113:function(s,t,e){s.exports=e.p+"assets/img/image2019-07-15_09.01.21.0e0d34f2.png"},338:function(s,t,e){s.exports=e.p+"assets/img/image-20190726214032585.f5bc62e4.png"},339:function(s,t,e){s.exports=e.p+"assets/img/image-20190715101542756.5934c00e.png"},340:function(s,t,e){s.exports=e.p+"assets/img/image-20190715193838012.eca23618.png"},378:function(s,t,e){"use strict";e.r(t);var a=e(0),r=Object(a.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"å®‰è£…-kubernetes-å•masterèŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-kubernetes-å•masterèŠ‚ç‚¹","aria-hidden":"true"}},[s._v("#")]),s._v(" å®‰è£… Kubernetes å•MasterèŠ‚ç‚¹")]),s._v(" "),a("p",[s._v("å¯¹äº Kubernetes åˆå­¦è€…ï¼Œæ¨èåœ¨é˜¿é‡Œäº‘é‡‡è´­å¦‚ä¸‹é…ç½®ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("3å° 2æ ¸4G çš„ECSï¼ˆçªå‘æ€§èƒ½å®ä¾‹ t5 ecs.t5-c1m2.largeæˆ–åŒç­‰é…ç½®ï¼Œå•å°çº¦ 0.4å…ƒ/å°æ—¶ï¼Œåœæœºæ—¶ä¸æ”¶è´¹ï¼‰")]),s._v(" "),a("li",[s._v("Cent OS 7.6")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=obezo3pg",target:"_blank",rel:"noopener noreferrer"}},[s._v("é¢†å–é˜¿é‡Œäº‘æœ€é«˜2000å…ƒçº¢åŒ…"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("Kuboard çš„ Live Demo ç¯å¢ƒä½¿ç”¨çš„æ˜¯å¦‚ä¸‹æ‹“æ‰‘ç»“æ„ï¼Œæœ¬æ–‡æ¡£æè¿°äº†å¦‚ä½•åœ¨å®Œæˆè¯¥ demo ç¯å¢ƒçš„æ­å»ºã€‚")]),s._v(" "),a("p",[s._v("å®Œæˆå®‰è£…åï¼Œå¯¹åº”çš„è½¯ä»¶ç‰ˆæœ¬ä¸ºï¼š")]),s._v(" "),a("ul",[a("li",[s._v("Kubernetes v1.15.0")]),s._v(" "),a("li",[s._v("Docker 18.09.7")])]),s._v(" "),a("p",[a("img",{attrs:{src:e(338),alt:"image-20190726214032585"}})]),s._v(" "),a("h2",{attrs:{id:"åˆ¶ä½œæ ‡å‡†æœºé•œåƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ¶ä½œæ ‡å‡†æœºé•œåƒ","aria-hidden":"true"}},[s._v("#")]),s._v(" åˆ¶ä½œæ ‡å‡†æœºé•œåƒ")]),s._v(" "),a("p",[s._v("é€šè¿‡ä½¿ç”¨æ ‡å‡†æœºé•œåƒï¼Œå¯ä»¥")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("é¿å…é‡å¤æ‰§è¡Œå¯¹æµ‹è¯•æœºå®‰è£…å¿…è¦è½¯ä»¶çš„è¿‡ç¨‹")])]),s._v(" "),a("li",[a("strong",[s._v("ä»¥ä¸€ç§ç›¸å¯¹æ ‡å‡†åŒ–çš„è¿‡ç¨‹ç®¡ç†æµ‹è¯•æœºçš„ç»´æŠ¤")])])]),s._v(" "),a("p",[s._v("æ ‡å‡†æœºé•œåƒä¸­é¢„è£…äº†å¦‚ä¸‹å†…å®¹ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("docker")]),s._v(" "),a("li",[s._v("nfs-utils")]),s._v(" "),a("li",[s._v("kubernetes images")])]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("ul",[a("li",[s._v("æ‚¨ä¹Ÿå¯ä»¥ä¸åˆ¶ä½œæ ‡å‡†æœºé•œåƒï¼Œè€Œæ˜¯åœ¨ä¸‰å°æœºå™¨ä¸Šéƒ½æ‰§è¡Œ "),a("em",[a("strong",[s._v("åˆ¶ä½œæ ‡å‡†æœºé•œåƒ")])]),s._v(" ä¸­çš„æ‰€æœ‰æ“ä½œæ­¥éª¤")])])]),s._v(" "),a("p",[a("strong",[s._v("æ ‡å‡†æœºé•œåƒçš„åˆ¶ä½œè¿‡ç¨‹æè¿°å¦‚ä¸‹ï¼š")])]),s._v(" "),a("h3",{attrs:{id:"å®‰è£…docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…docker","aria-hidden":"true"}},[s._v("#")]),s._v(" å®‰è£…docker")]),s._v(" "),a("p",[a("strong",[s._v("å¸è½½æ—§ç‰ˆæœ¬")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-client-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-common "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-latest-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-selinux "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-engine-selinux "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\tdocker-engine\n")])])]),a("p",[a("strong",[s._v("ä¸‹è½½ä¾èµ–åŒ…åŠå®‰è£…åŒ…")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-cli-18.09.7-3.el7.x86_64.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-18.09.7-3.el7.x86_64.rpm\n")])])]),a("p",[a("strong",[s._v("å®‰è£…")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y containerd.io-1.2.6-3.3.el7.x86_64.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce-cli-18.09.7-3.el7.x86_64.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce-18.09.7-3.el7.x86_64.rpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n")])])]),a("p",[a("strong",[s._v("å¯åŠ¨ docker æœåŠ¡")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start docker\n")])])]),a("p",[a("strong",[s._v("æ£€æŸ¥ docker ç‰ˆæœ¬")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\ndocker version\n")])])]),a("blockquote",[a("p",[a("strong",[s._v("å‚è€ƒæ–‡æ¡£")])]),s._v(" "),a("p",[s._v("https://docs.docker.com/install/linux/docker-ce/centos/")]),s._v(" "),a("p",[s._v("https://docs.docker.com/install/linux/linux-postinstall/")])]),s._v(" "),a("h3",{attrs:{id:"å®‰è£…-nfs-utils"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-nfs-utils","aria-hidden":"true"}},[s._v("#")]),s._v(" å®‰è£… nfs-utils")]),s._v(" "),a("p",[a("strong",[s._v("æ‰§è¡Œå®‰è£…å‘½ä»¤")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y nfs-utils\n")])])]),a("p",[s._v("å¿…é¡»å…ˆå®‰è£… nfs-utils æ‰èƒ½æŒ‚è½½ nfs ç½‘ç»œå­˜å‚¨")]),s._v(" "),a("h3",{attrs:{id:"k8såŸºæœ¬é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8såŸºæœ¬é…ç½®","aria-hidden":"true"}},[s._v("#")]),s._v(" K8SåŸºæœ¬é…ç½®")]),s._v(" "),a("p",[a("strong",[s._v("é…ç½®K8Sçš„yumæº")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v("EOF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/kubernetes.repo\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubernetes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Kubernetes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("baseurl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgcheck")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("repo_gpgcheck")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gpgkey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg\n       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF\n")])])]),a("p",[a("strong",[s._v("å…³é—­ é˜²ç«å¢™ã€SeLinuxã€swap")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\nsystemctl stop firewalld\nsystemctl disable firewalld\n\nsetenforce "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/SELINUX=enforcing/SELINUX=disabled/g"')]),s._v(" /etc/selinux/config\n\nswapoff -a\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/fstab /etc/fstab_bak\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/fstab_bak "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v swap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/fstab\n")])])]),a("p",[a("strong",[s._v("ä¿®æ”¹ /etc/sysctl.conf")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysctl.conf\n")])])]),a("p",[s._v("å‘å…¶ä¸­æ·»åŠ ")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("net.ipv4.ip_forward = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\n")])])]),a("p",[s._v("å¦‚ä¸‹å›¾æ‰€ç¤º")]),s._v(" "),a("p",[a("img",{attrs:{src:e(112),alt:"image-20190715085036593",title:":size=600x445"}})]),s._v(" "),a("p",[s._v("æ‰§è¡Œå‘½ä»¤ä»¥åº”ç”¨")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\nsysctl -p\n")])])]),a("p",[a("strong",[s._v("å®‰è£…kubeletã€kubeadmã€kubectl")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y kubelet-1.15.0 kubeadm-1.15.0 kubectl-1.15.0\n")])])]),a("p",[a("strong",[s._v("ä¿®æ”¹docker Cgroup Driverä¸ºsystemd")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/lib/systemd/system/docker.service\n")])])]),a("p",[s._v("å‘å…¶ä¸­æ·»åŠ ")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("--exec-opt native.cgroupdriver=systemd\n")])])]),a("p",[s._v("å¦‚ä¸‹å›¾æ‰€ç¤º")]),s._v(" "),a("p",[a("img",{attrs:{src:e(113),alt:"å±å¹•å¿«ç…§ 2019-07-15 09.01.21",title:":size=1000x326"}})]),s._v(" "),a("p",[s._v("é‡å¯ docker")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\nsystemctl daemon-reload\nsystemctl restart docker\n")])])]),a("p",[a("strong",[s._v("å¯åŠ¨kubelet")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" kubelet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start kubelet\n")])])]),a("p",[a("strong",[s._v("åŠ è½½ kubernetes é•œåƒ")])]),s._v(" "),a("p",[s._v("ç”±äºk8sæœåŠ¡ç›¸å…³é•œåƒåœ¨å›½å¤–é•œåƒæºï¼Œå›½å†…æ— æ³•è®¿é—®")]),s._v(" "),a("p",[s._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ·»åŠ docker k8så›½å†…é•œåƒæº")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -sSL https://get.daocloud.io/daotools/set_mirror.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -s http://f1361db2.m.daocloud.io\n\nsystemctl restart docker\n")])])]),a("p",[a("strong",[s._v("æ‹‰å–k8sç›¸å…³é•œåƒ")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\ndocker pull mirrorgooglecontainers/kube-apiserver:v1.15.0\ndocker pull mirrorgooglecontainers/kube-controller-manager:v1.15.0\ndocker pull mirrorgooglecontainers/kube-scheduler:v1.15.0\ndocker pull mirrorgooglecontainers/kube-proxy:v1.15.0\ndocker pull mirrorgooglecontainers/pause:3.1\ndocker pull mirrorgooglecontainers/etcd:3.3.10\ndocker pull coredns/coredns:1.3.1\n")])])]),a("p",[a("strong",[s._v("æ›´æ”¹é•œåƒåä¸ºk8så®˜ç½‘é•œåƒ")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),s._v("\ndocker tag d235b23c3570 k8s.gcr.io/kube-proxy:v1.15.0\ndocker tag 201c7a840312 k8s.gcr.io/kube-apiserver:v1.15.0\ndocker tag 2d3813851e87 k8s.gcr.io/kube-scheduler:v1.15.0\ndocker tag 8328bb49b652 k8s.gcr.io/kube-controller-manager:v1.15.0\ndocker tag da86e6ba6ca1 k8s.gcr.io/pause:3.1\ndocker tag eb516548c180 k8s.gcr.io/coredns:1.3.1\ndocker tag 2c4adeb21b4f k8s.gcr.io/etcd:3.3.10\n")])])]),a("p",[a("strong",[s._v("åˆ¶ä½œé•œåƒ")])]),s._v(" "),a("p",[s._v("è¯·å‚è€ƒé˜¿é‡Œäº‘åŸºäºECS "),a("a",{attrs:{href:"https://help.aliyun.com/document_detail/35109.html?spm=5176.2020520101.0.0.75fc4df5mtdFmV",target:"_blank",rel:"noopener noreferrer"}},[s._v("åˆ¶ä½œè™šæ‹Ÿæœºé•œåƒ"),a("OutboundLink")],1),s._v(" çš„æ–‡æ¡£")]),s._v(" "),a("h2",{attrs:{id:"åˆå§‹åŒ–-master-èŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–-master-èŠ‚ç‚¹","aria-hidden":"true"}},[s._v("#")]),s._v(" åˆå§‹åŒ– master èŠ‚ç‚¹")]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[s._v("ä»¥ root èº«ä»½åœ¨ demo-master-a-1 æœºå™¨ä¸Šæ‰§è¡Œ")])]),s._v(" "),a("p",[a("strong",[s._v("é…ç½® apiserver.demo çš„åŸŸå")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x.x.x.x  apiserver.demo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts\n")])])]),a("div",{staticClass:"warning custom-block"},[a("p",[s._v("è¯·æ›¿æ¢å…¶ä¸­çš„ x.x.x.x ä¸ºæ‚¨çš„ demo-master-a-1 çš„å®é™… ip åœ°å€")])]),s._v(" "),a("p",[a("strong",[s._v("åˆ›å»º ./kubeadm-config.yaml")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" ./kubeadm-config.yaml\n")])])]),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubeadm.k8s.io/v1beta1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterConfiguration\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kubernetesVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1.15.0\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("controlPlaneEndpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apiserver.demo:6443"')]),s._v("\n\n")])])]),a("p",[a("strong",[s._v("åˆå§‹åŒ– apiserver")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubeadm init --config"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kubeadm-config.yaml --upload-certs\n")])])]),a("p",[s._v("æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")]),s._v(" "),a("p",[a("img",{attrs:{src:e(339),alt:"image-20190715101542756",title:":size=800x388"}})]),s._v(" "),a("p",[a("strong",[s._v("åˆå§‹åŒ– root ç”¨æˆ·çš„ kubectl é…ç½®")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /root/.kube/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/.kube/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf /root/.kube/config\n")])])]),a("p",[a("strong",[s._v("å®‰è£… calico")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubectl apply -f https://docs.projectcalico.org/v3.6/getting-started/kubernetes/installation/hosted/kubernetes-datastore/calico-networking/1.7/calico.yaml\n")])])]),a("blockquote",[a("p",[s._v("å®‰è£…calicoï¼Œ è¯·å‚è€ƒhttps://docs.projectcalico.org/v3.6/getting-started/kubernetes/")])]),s._v(" "),a("p",[a("strong",[s._v("ç­‰å¾…calicoå®‰è£…å°±ç»ªï¼š")])]),s._v(" "),a("p",[s._v("æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç­‰å¾… 3-10 åˆ†é’Ÿï¼Œç›´åˆ°æ‰€æœ‰çš„å®¹å™¨ç»„å¤„äº Running çŠ¶æ€")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("watch")]),s._v(" kubectl get pod -n kube-system\n")])])]),a("p",[a("strong",[s._v("æ£€æŸ¥ master åˆå§‹åŒ–ç»“æœ")])]),s._v(" "),a("p",[s._v("åœ¨ master èŠ‚ç‚¹ demo-master-a-1 ä¸Šæ‰§è¡Œ")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubectl get nodes\n")])])]),a("h2",{attrs:{id:"åˆå§‹åŒ–-workerèŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–-workerèŠ‚ç‚¹","aria-hidden":"true"}},[s._v("#")]),s._v(" åˆå§‹åŒ– workerèŠ‚ç‚¹")]),s._v(" "),a("h3",{attrs:{id:"è·å¾—-joinå‘½ä»¤å‚æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è·å¾—-joinå‘½ä»¤å‚æ•°","aria-hidden":"true"}},[s._v("#")]),s._v(" è·å¾— joinå‘½ä»¤å‚æ•°")]),s._v(" "),a("p",[a("strong",[s._v("åœ¨ master èŠ‚ç‚¹ demo-master-a-1 èŠ‚ç‚¹æ‰§è¡Œ")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubeadm token create --print-join-command\n")])])]),a("p",[s._v("å¯è·å–kubeadm join å‘½ä»¤åŠå‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm token create å‘½ä»¤çš„è¾“å‡º")]),s._v("\nkubeadm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303\n")])])]),a("h3",{attrs:{id:"åˆå§‹åŒ–worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–worker","aria-hidden":"true"}},[s._v("#")]),s._v(" åˆå§‹åŒ–worker")]),s._v(" "),a("p",[a("strong",[s._v("é’ˆå¯¹æ‰€æœ‰çš„ worker èŠ‚ç‚¹æ‰§è¡Œ")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ worker èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x.x.x.x  apiserver.demo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts\nkubeadm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303\n")])])]),a("div",{staticClass:"tip custom-block"},[a("ul",[a("li",[s._v("å°† x.x.x.x æ›¿æ¢ä¸º demo-master-a-1 çš„å®é™… ip")]),s._v(" "),a("li",[s._v("å°† kubeadm join å‘½ä»¤åçš„å‚æ•°æ›¿æ¢ä¸ºä¸Šä¸€ä¸ªæ­¥éª¤ä¸­å®é™…ä» demo-master-a-1 èŠ‚ç‚¹è·å¾—çš„å‚æ•°")])])]),s._v(" "),a("h3",{attrs:{id:"æ£€æŸ¥åˆå§‹åŒ–ç»“æœ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ£€æŸ¥åˆå§‹åŒ–ç»“æœ","aria-hidden":"true"}},[s._v("#")]),s._v(" æ£€æŸ¥åˆå§‹åŒ–ç»“æœ")]),s._v(" "),a("p",[s._v("åœ¨ master èŠ‚ç‚¹ demo-master-a-1 ä¸Šæ‰§è¡Œ")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubectl get nodes\n")])])]),a("p",[a("img",{attrs:{src:e(340),alt:"image-20190715193838012"}})]),s._v(" "),a("h2",{attrs:{id:"ç§»é™¤-worker-èŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç§»é™¤-worker-èŠ‚ç‚¹","aria-hidden":"true"}},[s._v("#")]),s._v(" ç§»é™¤ worker èŠ‚ç‚¹")]),s._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",[s._v("æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‚¨æ— éœ€ç§»é™¤ worker èŠ‚ç‚¹ï¼Œå¦‚æœæ·»åŠ åˆ°é›†ç¾¤å‡ºé”™ï¼Œæ‚¨å¯ä»¥ç§»é™¤ worker èŠ‚ç‚¹ï¼Œå†é‡æ–°å°è¯•æ·»åŠ ")])]),s._v(" "),a("p",[s._v("åœ¨å‡†å¤‡ç§»é™¤çš„ worker èŠ‚ç‚¹ä¸Šæ‰§è¡Œ")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ worker èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubeadm reset\n")])])]),a("p",[s._v("åœ¨ master èŠ‚ç‚¹ demo-master-a-1 ä¸Šæ‰§è¡Œ")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubectl delete node demo-worker-x-x\n")])])]),a("div",{staticClass:"tip custom-block"},[a("ul",[a("li",[s._v("å°† demo-worker-x-x æ›¿æ¢ä¸ºè¦ç§»é™¤çš„ worker èŠ‚ç‚¹çš„åå­—")]),s._v(" "),a("li",[s._v("worker èŠ‚ç‚¹çš„åå­—å¯ä»¥é€šè¿‡åœ¨èŠ‚ç‚¹ demo-master-a-1 ä¸Šæ‰§è¡Œ kubectl get nodes å‘½ä»¤è·å¾—")])])]),s._v(" "),a("h2",{attrs:{id:"å®‰è£…-ingress-controller"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-ingress-controller","aria-hidden":"true"}},[s._v("#")]),s._v(" å®‰è£… Ingress Controller")]),s._v(" "),a("blockquote",[a("p",[s._v("Ingresså®˜æ–¹æ–‡æ¡£ï¼šhttps://kubernetes.io/docs/concepts/services-networking/ingress/")]),s._v(" "),a("p",[s._v("Ingress Controllerså®˜ç½‘ä»‹ç»ï¼šhttps://kubernetes.io/docs/concepts/services-networking/ingress-controllers/")]),s._v(" "),a("p",[s._v("æœ¬æ–‡ä¸­ä½¿ç”¨å¦‚ä¸‹éƒ¨ç½²æ–¹å¼ï¼šhttps://kubernetes.github.io/ingress-nginx/deploy/baremetal/#using-a-self-provisioned-edge")]),s._v(" "),a("p",[s._v("kubernetesæ”¯æŒå¤šç§Ingress Controllersï¼Œæœ¬æ–‡æ¨èä½¿ç”¨ https://github.com/nginxinc/kubernetes-ingress")])]),s._v(" "),a("p",[a("strong",[s._v("åœ¨ demo-master-a-1 ä¸Šæ‰§è¡Œ")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),s._v("\nkubectl apply -f https://raw.githubusercontent.com/eip-work/eip-monitor-repository/master/dashboard/nginx-ingress.yaml\n")])])]),a("p",[a("strong",[s._v("é…ç½®åŸŸåè§£æ")])]),s._v(" "),a("p",[s._v("å°†åŸŸå *.demo.yourdomain.com è§£æåˆ° demo-worker-a-2 çš„ IP åœ°å€ z.z.z.z ï¼ˆä¹Ÿå¯ä»¥æ˜¯ demo-worker-a-1 çš„åœ°å€ y.y.y.yï¼‰")]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[s._v("ç”±äºéœ€è¦ç”³è¯·åŸŸåï¼Œè¿‡ç¨‹ä¼šæ¯”è¾ƒç¹çï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§æ›¿ä»£æ–¹æ¡ˆï¼š")]),s._v(" "),a("ul",[a("li",[s._v("åœ¨æ‚¨çš„å®¢æˆ·ç«¯æœºå™¨ï¼ˆè®¿é—®éƒ¨ç½²åœ¨K8Sä¸Šçš„ web åº”ç”¨çš„æµè§ˆå™¨æ‰€åœ¨çš„æœºå™¨ï¼‰è®¾ç½® hosts é…ç½®ï¼›")]),s._v(" "),a("li",[s._v("æš‚æ—¶æ”¾å¼ƒåŸŸåçš„é…ç½®ï¼Œä¸´æ—¶ä½¿ç”¨ NodePort æˆ–è€… "),a("code",[s._v("kubectl port-forward")]),s._v(" çš„æ–¹å¼è®¿é—®éƒ¨ç½²åœ¨ K8S ä¸Šçš„ web åº”ç”¨")])])]),s._v(" "),a("p",[a("strong",[s._v("éªŒè¯é…ç½®")])]),s._v(" "),a("p",[s._v("åœ¨æµè§ˆå™¨è®¿é—® a.demo.yourdomain.comï¼Œå°†å¾—åˆ° 404 NotFound é”™è¯¯é¡µé¢")]),s._v(" "),a("h2",{attrs:{id:"ä¸‹ä¸€æ­¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‹ä¸€æ­¥","aria-hidden":"true"}},[s._v("#")]),s._v(" ä¸‹ä¸€æ­¥")]),s._v(" "),a("p",[s._v("ğŸ‰ ğŸ‰ ğŸ‰")]),s._v(" "),a("p",[s._v("æ‚¨å·²ç»å®Œæˆäº† Kubernetes é›†ç¾¤çš„å®‰è£…ï¼Œä¸‹ä¸€æ­¥è¯·ï¼š")]),s._v(" "),a("p",[a("a",{attrs:{href:"/install/install-dashboard"}},[s._v("å®‰è£… Kuboard")])])])},[],!1,null,null,null);t.default=r.exports}}]);